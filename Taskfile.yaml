---
# File generated by DataRobot CLI, regenerate using `dr task compose`
version: '3'
dotenv: ['.env', '.env.{{.ENV}}']
includes:
  frontend:
    taskfile: ./frontend/Taskfile.yaml
    dir: ./frontend
tasks:
  default:
    desc: "â„¹ï¸ Show all available tasks (run `task --list-all` to see hidden tasks)"
    cmds:
      - task --list --sort none
    silent: true

  start:
    desc: "ğŸš€ Quickstart"
    cmds:
      - dr self update
      - dr dotenv setup --if-needed
      - python quickstart.py

  lint:
    desc: "ğŸ§¹ Run linters"
    cmds:
      - ruff format --check .
      - ruff check .
      - mypy --pretty .

  fix-lint:
    desc: "ğŸ”§ Fix linting issues"
    cmds:
      - ruff format .
      - ruff check . --fix
      - mypy --pretty .

  install:
    desc: "ğŸ› ï¸ Install all dependencies"
    cmds:
      - python -m pip install -r requirements.txt
      - task: frontend:install

  dev:
    desc: "ğŸš€ Run Streamlit development server"
    cmds:
      - |
        task frontend:dev &
        sleep 3
        echo "âœ… Streamlit server started!"
        if [ -n "$NOTEBOOK_ID" ]; then
          prefix="$(echo "$DATAROBOT_ENDPOINT" | sed 's|/*$||' | sed 's|api/v2||')notebook-sessions/$NOTEBOOK_ID/ports/"
        else
          prefix="http://localhost:"
        fi
        echo "ğŸ”— Streamlit Frontend: ${prefix}8501"
        wait

  check-licenses:
    desc: "ğŸ“œ Check copyright headers"
    cmds:
      - docker run -it --rm -v $(pwd):/github/workspace apache/skywalking-eyes -c .github/.licenserc.yaml header check

  fix-licenses:
    desc: "ğŸ“ Fix copyright headers"
    cmds:
      - docker run -it --rm -v $(pwd):/github/workspace apache/skywalking-eyes -c .github/.licenserc.yaml header fix
